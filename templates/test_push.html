<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🧪 Test Push Notifications</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>🧪 Test Push Notifications</h1>
    
    <div class="test-section">
        <h2>🔔 Basic JavaScript Test</h2>
        <button onclick="testBasic()">Test Basic JavaScript</button>
        <div id="basic-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>📱 Service Worker Test</h2>
        <button onclick="testServiceWorker()">Test Service Worker</button>
        <div id="sw-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>🔑 VAPID Key Test</h2>
        <button onclick="testVapidKey()">Test VAPID Key</button>
        <div id="vapid-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>🚀 Full System Test</h2>
        <button onclick="testFullSystem()">Test Full System</button>
        <div id="full-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>📝 Console Log Test</h2>
        <button onclick="testConsole()">Test Console Logging</button>
        <div id="console-result" class="result"></div>
    </div>

    <script>
        console.log('🚀 Test page JavaScript loaded!');
        
        function logResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = message;
                element.className = `result ${type}`;
            }
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        function testBasic() {
            console.log('🧪 Testing basic JavaScript...');
            try {
                const time = new Date().toLocaleTimeString();
                const message = `✅ Basic JavaScript working! Time: ${time}`;
                logResult('basic-result', message, 'success');
                alert(message);
            } catch (error) {
                const message = `❌ Basic JavaScript error: ${error.message}`;
                logResult('basic-result', message, 'error');
                alert(message);
            }
        }
        
        function testServiceWorker() {
            console.log('🧪 Testing Service Worker...');
            try {
                if ('serviceWorker' in navigator) {
                    logResult('sw-result', '✅ Service Worker supported', 'success');
                    
                    // Try to register service worker
                    navigator.serviceWorker.register('/static/js/push-sw.js')
                        .then(function(registration) {
                            logResult('sw-result', `✅ Service Worker registered: ${registration.scope}`, 'success');
                        })
                        .catch(function(error) {
                            logResult('sw-result', `❌ Service Worker registration failed: ${error.message}`, 'error');
                        });
                } else {
                    logResult('sw-result', '❌ Service Worker not supported', 'error');
                }
            } catch (error) {
                logResult('sw-result', `❌ Service Worker test error: ${error.message}`, 'error');
            }
        }
        
        function testVapidKey() {
            console.log('🧪 Testing VAPID key...');
            try {
                fetch('/api/push/vapid-key')
                    .then(response => {
                        if (response.ok) {
                            return response.json();
                        } else {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    })
                    .then(data => {
                        const key = data.public_key ? data.public_key.substring(0, 50) + '...' : 'Not found';
                        logResult('vapid-result', `✅ VAPID key received: ${key}`, 'success');
                    })
                    .catch(error => {
                        logResult('vapid-result', `❌ VAPID key error: ${error.message}`, 'error');
                    });
            } catch (error) {
                logResult('vapid-result', `❌ VAPID test error: ${error.message}`, 'error');
            }
        }
        
        function testConsole() {
            console.log('🧪 Testing console logging...');
            console.warn('⚠️ This is a warning message');
            console.error('❌ This is an error message');
            console.info('ℹ️ This is an info message');
            
            const message = '✅ Console logging working! Check browser console for messages.';
            logResult('console-result', message, 'success');
            alert(message);
        }
        
        function testFullSystem() {
            console.log('🧪 Testing full system...');
            try {
                // Test 1: Basic functionality
                if (typeof testBasic === 'function') {
                    console.log('✅ Basic functions available');
                }
                
                // Test 2: Service Worker support
                if ('serviceWorker' in navigator) {
                    console.log('✅ Service Worker supported');
                }
                
                // Test 3: Push Manager support
                if ('PushManager' in window) {
                    console.log('✅ Push Manager supported');
                }
                
                // Test 4: Notification support
                if ('Notification' in window) {
                    console.log('✅ Notifications supported');
                }
                
                const message = '✅ Full system test completed! Check console for details.';
                logResult('full-result', message, 'success');
                alert(message);
                
            } catch (error) {
                const message = `❌ Full system test error: ${error.message}`;
                logResult('full-result', message, 'error');
                alert(message);
            }
        }
        
        // Auto-run basic test when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 DOM loaded, running basic test...');
            setTimeout(testBasic, 1000);
        });
        
        console.log('🚀 All test functions loaded!');
    </script>
</body>
</html>

